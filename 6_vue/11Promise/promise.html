<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<body>

</body>
<script>
    //promise是对回调的一种封装，对回调进行一些规范


    // const promise = new Promise(function (resolve, reject) {
    //     console.log('promise')
    //     //异步操作，类似图片加载，ajax
    //     if (true) {
    //         //异步操作成功
    //         let value = 200;
    //         resolve(value);
    //     } else {
    //         //异步操作失败
    //         let error = '操作失败';
    //         reject(error);
    //     }
    // })
    // //调用promise
    // promise.then(function (value) {
    //     //成功方法
    //     console.log(value)
    // },function (error) {
    //     //失败方法
    //     console.log(error)
    // })
    // console.log('promise later')
    //
    // function timeOut(time) {
    //     return new Promise(function (resolve, reject) {
    //         setTimeout(resolve,time,'wuxianyijin')
    //     })
    // }
    // timeOut(3000).then(function (value) {
    //     console.log(value)
    // })
    
    

    //图片加载
    // function loadImage(url) {
    //     return new Promise((resolve, reject) => {
    //         const image = new Image();
    //         image.onload = function () {
    //             resolve(image);
    //         };
    //         image.onerror = function () {
    //             reject(new Error('image error'));
    //         }
    //         image.src = url;  //此时才真正加载图片
    //     })
    // }
    // loadImage('./yuxiang.jpg').then((img) => {
    //     console.log(img);
    //     document.body.appendChild(img)
    // },(err) => {
    //     console.log(err);
    // });
    
    
    //Ajax
    function ajax(url) {
        return new Promise((resolve, reject) => {
            let xhr = null;
            if (window.XMLHttpRequest) {
                xhr = new XMLHttpRequest();
            } else {
                xhr = new ActiveXObject("Microsoft.XMLHTTP");
            }

            xhr.onreadystatechange = function () {
                if (xhr.readyState == 4) {
                    // let theData = JSON.parse(xhr.responseText);
                    resolve(xhr.responseText)
                } else {
                    reject(new Error('load error'))
                }
            }

            xhr.open("get",url,true);
            xhr.send();
        })
    }
    ajax('baidu.com').then((res) => {
        console.log(res);
    }, (err) => {
        console.log(err);
    })
</script>
</html>